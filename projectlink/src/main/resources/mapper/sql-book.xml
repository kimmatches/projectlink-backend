<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="book.mapper.BookMapper">

	<!-- 도서 목록 조회 -->
	<select id="selectBookList" resultType="book.dto.BookDto">
		SELECT book_id, title, author, publisher, publish_date, description,
		created_at, updated_at
		FROM Books
		ORDER BY book_id DESC
	</select>

	<!-- 도서 등록 -->
	<insert id="insertBook" parameterType="book.dto.BookDto"
		useGeneratedKeys="true" keyProperty="bookId">
		INSERT INTO Books (title, author, publisher, publish_date, description,
		created_at, updated_at)
		VALUES (#{title}, #{author}, #{publisher}, #{publishDate}, #{description},
		now(), now())
	</insert>


	<!-- 도서 상세 조회 -->
	<select id="selectBookDetail" parameterType="int"
		resultType="book.dto.BookDto">
		SELECT book_id, title, author, publisher, publish_date, description,
		created_at, updated_at
		FROM Books
		WHERE book_id = #{bookId}
	</select>

	<!-- 도서 수정 -->
	<update id="updateBook" parameterType="book.dto.BookDto">
		UPDATE Books
		SET title = #{title}, author = #{author}, publisher = #{publisher},
		publish_date = #{publishDate},
		description = #{description}, updated_at = CURRENT_TIMESTAMP
		WHERE book_id = #{bookId}
	</update>

	<!-- 도서 삭제 -->
	<delete id="deleteBook" parameterType="int">
		DELETE FROM Books
		WHERE book_id = #{bookId}
	</delete>
</mapper>
